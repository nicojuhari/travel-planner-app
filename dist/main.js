!function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([function(e,t,a){},function(e,t,a){"use strict";a.r(t);const n=(e,t)=>Math.ceil(Math.abs(new Date(t)-new Date(e))/864e5),s=e=>Math.round(Number(e)-160/9),i=e=>document.getElementById(e).scrollIntoView({behavior:"smooth"}),o=e=>Math.ceil((new Date(e)-Date.now())/864e5)>=0,d=e=>{const t=document.getElementById("error-block");t.querySelector(".js-err-message").innerHTML=e,t.classList.add("active")},r=(e="")=>{const t=document.getElementById("trip-create");"active"==e?(t.classList.remove("loading"),t.classList.add("active")):"loading"==e?(t.classList.remove("active"),t.classList.add("loading")):(t.classList.remove("active"),t.classList.remove("loading"))},c=()=>{let e="";const t=document.getElementById("location"),a=document.getElementById("destination"),n=document.getElementById("date-start"),s=document.getElementById("date-end");var i,r;return t.value.length<3?(t.classList.remove("valid"),t.classList.add("error"),e+="<p>Please, add the Current Location!</p>"):(t.classList.remove("error"),t.classList.add("valid")),a.value.length<3?(a.classList.remove("valid"),a.classList.add("error"),e+="<p>Please, add the Destination!</p>"):(a.classList.remove("error"),a.classList.add("valid")),o(n.value)&&""!=n.value?(n.classList.remove("error"),n.classList.add("valid")):(n.classList.add("error"),n.classList.remove("valid"),e+="<p>Please, select the Departing Date <br>(The Date cannot be before today)</p>"),i=n.value,r=s.value,Math.ceil((new Date(r)-new Date(i))/864e5)>0&&o(s.value)&&""!=s.value?(s.classList.remove("error"),s.classList.add("valid")):(s.classList.add("error"),s.classList.remove("valid"),e+="<p>Please, select the Returning Date <br>(The Date cannot be before the Departing Date)</p>"),e?(document.getElementById("search").classList.remove("disabled"),d(e),!1):(document.getElementById("search").classList.add("disabled"),{location:t.value,destination:a.value,dateStart:n.value,dateEnd:s.value})},l=async(e,t="")=>{const a=`http://api.geonames.org/searchJSON?q=${e}&country=${t}&maxRows=3&username=nicojuhari`,n=await fetch("https://cors-anywhere.herokuapp.com/"+a);try{const t=await n.json();return 0==t.totalResultsCount?{error:"The "+e+" can't be found"}:t}catch(e){console.log(e)}},v=async e=>{const t=`https://pixabay.com/api/?key=13896601-3770d09841443b05f99f90d2f&q=${e=e.replace(/\s/g,"+")}&image_type=photo&pretty=true`,a=await fetch(t);try{return await a.json()}catch(e){console.log(e)}},m=()=>{let e=localStorage.getItem("tp_capstone");if(document.getElementById("trip-list").classList.remove("active"),document.querySelector("nav li").classList.remove("active"),e&&JSON.parse(e).length>0){const t=document.getElementById("trips-list-content");document.querySelector("nav li").classList.add("active"),t.innerHTML="",t.appendChild(((e="")=>{let t="";const a=document.createElement("div");a.classList.add("all-trips");let i=0;for(let a of e){let e=n(new Date,a[0].dateStart);for(var o of(t+=`<div class="trip-container" data-trip-nr="${i}">\n                        <div class="trip-container__header">\n                            <h4 class="trip-container__title"><span class="num-icon">${a.length}</span> destination${a.length>1?"s":""}</h4>\n                            <div class="trip-container__remain">Trip will start in <span class="num-icon">${e}</span> days</div>\n                        </div>\n                    <div class="trip__block">`,a))t+=`<div class="trip__destination">\n            <div class="loc__image" ${0!=o.image?'style="background-image: url('+o.image+')"':""}></div>\n            <div class="loc__info">\n                <h2 class="loc__name">\n                    <span class="loc__city">${o.destination.city}</span>,\n                    <span class="loc__country">${o.destination.country}</span>\n                </h2>\n                <div class="loc__dates">\n                    <div class="loc__date">\n                        <div class="start-end-date">\n                            <span class="date-start">${o.dateStart}</span>\n                            -\n                            <span class="date-end">${o.dateEnd}</span>\n                            /\n                            <span class="total-days">${n(o.dateStart,o.dateEnd)} days</span>\n                        </div>\n                    </div>\n                    <div class="loc__remain">\n                        The Trip will start in: <span class="remain-days">${n(new Date,o.dateStart)}</span> days\n                    </div>\n                </div>\n                <div class="loc__weather weather">\n                    <div class="weather__title">Weather forecast:</div>\n                    <div class="weather__content">\n                        <div class="weather__icon">\n                            <img src="https://darksky.net/images/weather-icons/${o.weather.icon}.png"/>\n                        </div>\n                        <div class="weather__info">\n                            <div class="weather__data"><span>${s(o.weather.temperatureMax)}</span> &deg;C</div>\n                            <div class="weather__commnents">${o.weather.summary}</div>\n                        </div>\n                    </div>\n                </div>\n                ${o.toDoList.length>0?`<div class="todo-block">\n                                                <div class="todo__title">To Do List</div>\n                                                <div class="todo__content">\n                                                    ${o.toDoList.map(e=>'<span class="todo__item">'+e+"</span>").join("")}\n                                                </div>\n                                            </div>`:""}\n            </div>\n        </div>`;t+=`</div>\n                    <div class="trip-container__actions">\n                        <div class="action-btn remove-trip" data-trip-nr="${i}" title="Remove The Trip"></div>\n                    </div>\n        \n                    </div>`,i++}return a.innerHTML=t,a})(JSON.parse(e))),document.getElementById("trip-list").classList.add("active")}};document.addEventListener("DOMContentLoaded",()=>{m();const e=document.getElementById("trips-list-content");document.querySelector("nav a");e.addEventListener("click",(function(e){e.target.classList.contains("remove-trip")&&((e=>{let t=JSON.parse(localStorage.getItem("tp_capstone")).filter((t,a)=>a!=e);localStorage.setItem("tp_capstone",JSON.stringify(t))})(e.target.dataset.tripNr),m())}),!0)});const p=async e=>{let t={};return t.dateStart=e.dateStart,t.dateEnd=e.dateEnd,t.toDoList=[],t.error="",await l(e.location).then(e=>{e.error?t.error=e.error:t.location={city:e.geonames[0].toponymName,lat:e.geonames[0].lat,lng:e.geonames[0].lng}}),await l(e.destination).then(e=>{e.error?t.error=e.error:t.destination={city:e.geonames[0].toponymName,country:e.geonames[0].countryName,lat:e.geonames[0].lat,lng:e.geonames[0].lng}}),""==t.error&&(await(async(e,t,a="")=>{const n=`https://api.darksky.net/forecast/aff1f0a06b6fcb4d76f2fe8dad6bb0db/${e},${t},${new Date(a)/1e3}`,s=await fetch("https://cors-anywhere.herokuapp.com/"+n);try{return await s.json()}catch(e){console.log(e)}})(t.destination.lat,t.destination.lng,e.dateStart).then(e=>{t.weather={temperatureMax:e.daily.data[0].temperatureMax,temperatureMin:e.daily.data[0].temperatureMin,summary:e.daily.data[0].summary,icon:e.daily.data[0].icon}}),await v(t.destination.city).then(e=>{e.totalHits>0?t.image=e.hits[0].largeImageURL:v(t.destination.country).then(e=>{e.totalHits>0?t.image=e.hits[0].largeImageURL:t.image=!1})})),t},u=()=>{const e=document.getElementById("trip-form").querySelectorAll("input"),t=document.getElementById("search");e.forEach(e=>{e.value="",e.disabled=!1,e.classList.remove("valid")}),t.classList.remove("disabled"),document.getElementById("trip-create").classList.remove("active"),m(),i("trip-list")};let g=[];const y=e=>{const t=document.getElementById("new-trip");t.innerHTML="",t.appendChild((e=>{let t="",a=0;var i=document.createElement("div");i.classList.add("trip__block");for(let i of e)t+=`<div class="trip__destination">\n                        <div class="loc__image" ${0!=i.image?'style="background-image: url('+i.image+')"':""}></div>\n                        <div class="loc__info">\n                            <h2 class="loc__name">\n                                <span class="loc__city">${i.destination.city}</span>,\n                                <span class="loc__country">${i.destination.country}</span>\n                            </h2>\n                            <div class="loc__dates">\n                                <div class="loc__date">\n                                    <div class="start-end-date">\n                                        <span class="date-start">${i.dateStart}</span>\n                                        -\n                                        <span class="date-end">${i.dateEnd}</span>\n                                        /\n                                        <span class="total-days">${n(i.dateStart,i.dateEnd)} days</span>\n                                    </div>\n                                </div>\n                                <div class="loc__remain">\n                                    The Trip will start in: <span class="remain-days">${n(new Date,i.dateStart)}</span> days\n                                </div>\n                            </div>\n                            <div class="loc__weather weather">\n                                <div class="weather__title">Weather forecast:</div>\n                                <div class="weather__content">\n                                    <div class="weather__icon">\n                                        <img src="https://darksky.net/images/weather-icons/${i.weather.icon}.png"/>\n                                    </div>\n                                    <div class="weather__info">\n                                        <div class="weather__data"><span>${s(i.weather.temperatureMax)}</span> &deg;C</div>\n                                        <div class="weather__commnents">${i.weather.summary}</div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            ${i.toDoList.length>0?`<div class="todo-block">\n                                                            <div class="todo__title">To Do List</div>\n                                                            <div class="todo__content">\n                                                                ${i.toDoList.map(e=>'<span class="todo__item">'+e+"</span>").join("")}\n                                                            </div>\n                                                        </div>`:""}\n\n                        </div>\n                        <div class="new-dest-actions" data-dest-nr="${a}">\n                            <div class="add-to-do" title="Add To Do List">\n                                <span class="add-to-do__icon">+</span> add to do list\n                            </div>\n                        </div>\n                    </div>`,a++;return t+='<div id="new-trip-actions" class="trip__actions">\n                        <div class="nt-btn add-more">\n                            <div id="add-more-destination" class="add-more-icon">+</div>\n                            <p>Add More Destinations</p>\n                        </div>\n                        <div class="nt-btn save-trip">\n                            <div id="save-new-trip" class="save-trip-icon"><span></span></div>\n                            <p>Save the Trip</p>\n                        </div>\n                    </div>',i.innerHTML=t,i})(e))};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("search"),t=document.getElementById("new-trip"),a=document.querySelectorAll(".js-popup-close"),n=document.querySelector(".save-to-do"),s=document.querySelector("nav a");e.addEventListener("click",()=>{if(!e.classList.contains("disabled")){let e=c();e&&(r("loading"),i("trip-create"),p(e).then(e=>{e.error?(r(),i("trip-form"),d(e.error),document.getElementById("search").classList.remove("disabled")):(g.push(e),y(g),r("active"))}))}}),t.addEventListener("click",e=>{if("add-more-destination"==e.target.getAttribute("id")&&(e=>{const t=e.slice(),a=document.getElementById("location"),n=document.getElementById("destination"),s=document.getElementById("date-start"),o=document.getElementById("date-end"),d=t.reverse()[0],r=d.dateEnd,c=d.destination.city;a.value=c,n.value="",s.value=r,o.value="",a.disabled=!0,s.disabled=!0,n.classList.remove("valid"),o.classList.remove("valid"),document.getElementById("search").classList.remove("disabled"),i("trip-form")})(g),"save-new-trip"==e.target.getAttribute("id")&&(e=>{if(void 0!==window.localStorage){let t=[];return t=localStorage.getItem("tp_capstone")?[...JSON.parse(localStorage.getItem("tp_capstone")),e]:[e],localStorage.setItem("tp_capstone",JSON.stringify(t)),u(),!0}return alert("Your Browser doesn't support the local storage. \nPlease, update your browser!"),!1})(g)&&(g=[]),e.target.classList.contains("add-to-do")){(e=>{const t=document.getElementById("to-do-list");t.querySelector('input[type="text"]').value="",t.querySelector('input[type="hidden"]').value=e,t.classList.add("active")})(e.target.closest(".new-dest-actions").getAttribute("data-dest-nr"))}},!0),a.forEach(e=>{e.addEventListener("click",(function(t){e.closest(".full-screen").classList.remove("active")}),!0)}),s.addEventListener("click",e=>{e.preventDefault(),i(e.target.dataset.nav)}),n.addEventListener("click",(function(e){g=_(g),y(g)}),!0)});const _=e=>{const t=document.querySelector('input[name="to-do-list"]').value,a=document.querySelector('input[name="trip-dest-nr"]').value;return t.length>3&&(e[a].toDoList.push(t),document.getElementById("to-do-list").classList.remove("active")),e};a(0)}]);